## Enumeration Windows shares ##

## Enumeration from Windows ##
nbtstat /?
nbtstat -A <IP>     // displays information about a target
// Type: <20> record tells us that the file sharing service is up and running on the box
NET VIEW <target IP>    // enumerate the shares


## Enumeration from Linux ##
nmblookup --help
nmblookup -A <target IP>

smbclient -L //<target IP> -N   //enumeration of shares provided by the host


## Null Sessions (legacy systems only) ##

## Checking for Null Session with Windows ##
NET USE \\<target IP>\IPC$ '' /u:''

## Checking for Null Session with Linux ##
smbclient //<target IP>/IPC$ -N

## Exploiting Null Sessions with Enum from Windows ##
enum -S <target IP>     // enumerate the shares + administrative shares
enum -U <target IP>     // enumerate the users
enum -P <target IP>     // check the password policy (for network authentication attacks)
winfo <target IP> -n    // -n to use null sessions

## Exploiting Null Sessions with Enum4linux from Linux ##
enum4linux
