## Enumeration Windows shares ##
Ports: 135, 139, 445

## Enumeration from Windows ##
nbtstat /?
nbtstat -A <IP>     // displays information about a target
// Type: <20> record tells us that the file sharing service is up and running on the box
NET VIEW <target IP>    // enumerate the shares


## Enumeration from Linux ##
nmblookup --help
nmblookup -A <target IP>

smbclient -L //<target IP> -N   //enumeration of shares provided by the host


## Null Sessions (legacy systems only) ##

## Checking for Null Session with Windows ##
NET USE \\<target IP>\IPC$ '' /u:''

## Checking for Null Session with Linux ##
smbclient //<target IP>/IPC$ -N

## Null Sessions with Enum from Windows ##
enum -S <target IP>     // enumerate the shares + administrative shares
enum -U <target IP>     // enumerate the users
enum -P <target IP>     // check the password policy (for network authentication attacks)
winfo <target IP> -n    // -n to use null sessions

## Null Sessions with Enum4linux from Linux ##
enum4linux
enum4linux -v -n targetIP    // nmblookup (4 linux) / nbtstat (4 windows)
enum4linux -v -P targetIP    // enumerate Password Policy of system
enum4linux -v -S targetIP    // enumerate Shares + administrative shares
enum4linux -v -s /usr/share/enum4linux/share-list.txt targetIP     // enumerate shares from wordlist
enum4linux -v -a targetIP    // all simple enumeration (-U -S -G -P -r -o -n -i)

## Null Sessions with Impacket from Linux ##
(/usr/share/doc/python-impacket-doc/examples)
samrdump.py targetIP

## Null Sessions with Nmap ##
nmap --script=smb-enum-shares targetIP
nmap --script=smb-enum-users targetIP
nmap --script=smb-brute targetIP       // tries to brute force remote usernames & passwords

## Exploiting Null Sessions with Smbclient ##
smbclient -W 'WORKGROUP' //'targetIP'/'IPC$' -U''%''
