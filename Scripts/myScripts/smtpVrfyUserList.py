#!/usr/bin/python

import socket
import sys

if len(sys.argv) != 3:
	print 'Usage: python ' + sys.argv[0] ' <targetIP> <usernameList>'
        print 'Provide a file with usernames line by line as <usernameList>'
	print 'Only works on machines with port 25 open'
	sys.exit(0)
###

targetIP = sys.argv[1]
userList = sys.argv[2]

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Create the socket
connect = s.connect((targetIP, 25))	              # Connect to the smtp (port 25) server

banner = s.recv(1024)
print banner

with open(userList) as fp:
    for line in fp:
        s.send('VRFY ' + line + '\r\n') # Verify a user
        results = s.recv(1024)
        print result
###

s.close	# Close the socket
